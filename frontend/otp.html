<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Real-Time OTP Validation</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h2>OTP Verification</h2>
    <div class="form-group">
      <label for="phone">Phone Number:</label>
      <input type="text" id="phone" placeholder="Enter phone number" />
      <button onclick="generateOTP()">Get OTP</button>
    </div>

    <div class="form-group">
      <label for="otp">Enter OTP:</label>
      <input type="text" id="otp" placeholder="Enter OTP" />
      <button onclick="validateOTP()">Validate OTP</button>
    </div>

    <div id="timer"></div>
    <div id="message"></div>
  </div>

  <script>
    const API_URL = 'http://localhost:3000';
let countdown;

function generateOTP() {
  const phone = document.getElementById('phone').value;
  fetch(`${API_URL}/generate-otp`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ phone })
  })
    .then(response => response.json())
    .then(data => {
      document.getElementById('message').innerText = data.message;
      startCountdown(300);
    })
    .catch(err => console.error(err));
}
async function generateOTP() {
    try {
        let response = await fetch("https://your-api-endpoint.com/get-otp");

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        let data = await response.json();
        console.log("OTP Generated:", data);
    } catch (error) {
        console.error("Error fetching OTP:", error.message);
        alert("Failed to generate OTP. Please check your connection or try again.");
    }
}


function validateOTP() {
  const phone = document.getElementById('phone').value;
  const otp = document.getElementById('otp').value;

  fetch(`${API_URL}/validate-otp`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ phone, otp })
  })
    .then(response => response.json())
    .then(data => {
      document.getElementById('message').innerText = data.message;
      if (data.message === 'OTP verified successfully') clearInterval(countdown);
    })
    .catch(err => console.error(err));
}

function startCountdown(seconds) {
  let time = seconds;
  countdown = setInterval(() => {
    const minutes = Math.floor(time / 60);
    const secs = time % 60;
    document.getElementById('timer').innerText = `OTP expires in ${minutes}:${secs < 10 ? '0' : ''}${secs}`;
    time--;
    if (time < 0) {
      clearInterval(countdown);
      document.getElementById('timer').innerText = 'OTP expired';
    }
  }, 1000);
}
  </script>
</body>
</html>
